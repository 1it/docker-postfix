# =============================================================================
# Direct Delivery Mode (default)
# Sends mail directly to recipient MX servers over port 25.
# Requires: outbound port 25 open, proper DNS records (PTR, SPF, DKIM, DMARC).
# =============================================================================
services:
  postfix:
    image: 01it/postfix:latest
    container_name: postfix
    environment:
      - DOMAIN=example.com
      - MAILNAME=mail.example.com
      - MY_NETWORKS=127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
      - DKIM_SELECTOR=mail
      # --- Uncomment for relay mode ---
      # - RELAY_HOST=[smtp.example.com]:587
      # - SMTP_USERNAME=your-username
      # - SMTP_PASSWORD=your-password
      # --- Uncomment for Let's Encrypt (requires port 80 accessible) ---
      # - LETSENCRYPT_EMAIL=admin@example.com
      # --- Optional: self-signed certificate settings ---
      # - SSL_COUNTRY=US
      # - SSL_STATE=California
      # - SSL_LOCALITY=San Francisco
      # - SSL_ORGANIZATION=Example
      # - SSL_ORGANIZATIONAL_UNIT=IT Department
    ports:
      - "25:25"
      - "587:587"
    volumes:
      - postfix_data:/var/spool/postfix
      - postfix_certs:/etc/ssl/postfix
      - dkim_keys:/etc/ssl/dkim
      # - letsencrypt:/etc/letsencrypt
    restart: unless-stopped

volumes:
  postfix_data:
  postfix_certs:
  dkim_keys:
  # letsencrypt:
